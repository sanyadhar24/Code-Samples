---
title: "HW 9 Code"
author: "Sanya Malhotra"
date: "4/14/2022"
output:
  pdf_document:
    number_sections: false
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

H0: difference between male and female scores = 0 
H1: difference between male and female scores =/ 0
```{r}
library(tidyverse)

setwd("/Users/sanyamalhotra/Downloads/Datsets")
Data = read.csv("AFQT.csv")
Data
```

```{r}
newData = Data %>% group_by(Gender)

meanGender= newData %>%
  summarise(Arith=mean(Arith), Word=mean(Word),Parag=mean(Parag),Math=mean(Math))

meanGender=meanGender[,2:ncol(meanGender)] 
meanGender
varGender= newData %>%
  summarise(Arith=var(Arith), Word=var(Word),Parag=var(Parag),Math=var(Math))
varGender=varGender[,2:ncol(varGender)] 
varGender 
numGender=count(newData) 
numGender=numGender[,2] 
numGender=as.matrix(numGender)
varGender=varGender/(numGender) 
x_bar=meanGender[2,] -meanGender[1,] 
se=sqrt(varGender[1,]+varGender[2,])

c = qnorm(1 - .05/2)
test_arith = abs(x_bar$Arith/se$Arith)
test_arith
if(test_arith>c){
  print("Reject H0")
} else{
  print("HO is true")
}
p_value_arith = 2 * (1 - pnorm(test_arith))

test_word = abs(x_bar$Word/se$Word)
if(test_word>c){
  print("Reject H0")
} else{
  print("HO is true")
}
p_value_word = 2*(1 - pnorm(test_word))

test_parag = abs(x_bar$Parag/se$Parag)
if(test_parag>c){
  print("Reject H0")
} else{
  print("HO is true")
}
p_value_parag = 2 * (1 - pnorm(test_parag))

test_math = abs(x_bar$Math/se$Math)
if(test_math>c){
  print("Reject H0")
} else{
  print("HO is true")
}
p_value_math = 2 * (1 - pnorm(test_math))



```
H0: difference between unaffected and affected = 0 
H1: difference between unaffected and affected =/ 0 
Change to non-independent variables 



```{r}
getwd()
setwd("/Users/sanyamalhotra/Downloads/Datsets")
Schizo = read.csv("schizophrenia2.csv")
Schizo
affected = Schizo[,"Affected"]
unaffected = Schizo[,"Unaffected"] 
diff_schiz = Schizo[,"Affected"]  - Schizo[,"Unaffected"] 
x_bar2 <- mean(diff_schiz)
se2 <- sqrt(var(diff_schiz)/length(diff_schiz))

c2 = qnorm(1-.1/2)
test = abs(x_bar2/se2)
if(test > c){
  print("Reject H0")
} else{
  print("H0 is true")
}
p_value_schiz = 2 * (1 - pnorm(test))

```


```{r}
alpha = .05 

c_twosided = qnorm(1 - alpha/2)
c_onesided = qnorm(1 - alpha)
c_twosided
c_onesided 
```

```{r}
regression = lm(formula = AFQT ~ Gender, data = Data)
summary(regression)

diff_AFQT = Data %>% group_by(Gender) %>% summarize_if(is.numeric, mean) %>%
  pull(AFQT) %>% diff 
diff_AFQT

```
5) c. The slope coefficient is equal to it because the difference in the means of test scores would equal the change of x (males) needed to get the change in mean score (y)  
```{r}

Schools = read_csv("CASchools.csv")
Schools
```
```{r}
regression2 = lm(formula = math ~ teachers, data = Schools)
summary(regression2)

regression3 = lm(formula = math ~ teachers + students, data = Schools)
summary(regression3)

regression4 = lm(formula = math ~ (teachers/students), data = Schools)
summary(regression4)
```
6. b) -.01 change to math test scores with an additional teacher

d) Number of students will change the predicted value of how teachers affects test scores since math scores stays the same but the regression formula changes. 

e) much smaller effect on math scores

f) The last regression from part e)
```{r}

Houses = read_csv("HousePrices.csv")
Houses
```
```{r}

house_regression = lm(formula = price ~ lotsize + bedrooms + bathrooms + stories + driveway + recreation + stories + driveway + recreation + gasheat + aircon + garage + prefer + fullbase, data = Houses)
houseData = data.frame(stories = c(2), lotsize = c(6000), bedrooms = c(3), bathrooms = c(1), prefer = c("yes"), driveway = c("no"), recreation = c("no"), garage = c(1), aircon = c("yes"), gasheat = c("no"), fullbase = c("yes"))
a = predict(house_regression, houseData)
house_two = data.frame(stories = c(2), lotsize = c(6000), bedrooms = c(3), bathrooms = c(1), prefer = c("yes"), driveway = c("no"), recreation = c("yes"), garage = c(1), aircon = c("yes"), gasheat = c("no"), fullbase = c("yes"))
b = predict(house_regression, house_two)
house_three = data.frame(stories = c(2), lotsize = c(6000), bedrooms = c(3), bathrooms = c(1), prefer = c("yes"), driveway = c("no"), recreation = c("no"), garage = c(1), aircon = c("yes"), gasheat = c("yes"), fullbase = c("yes"))
c = predict(house_regression, house_three)
value_change_one = (b-a)/a
value_change_one
value_change_two = (c-a)/a
value_change_two
```




